/**
*   Paginator v0.1
*/
!function(a){var b=function(){var b={},c={},d={url:null,data:null,params:null,pageSize:20,btnDefault:"btn-default",btnActive:"btn-primary",pagination:"client",parse:function(a){return a&&a.resultSet?a.resultSet:[]},render:function(a){return console.log("You must override the 'render' function"),"<div class=''>"+JSON.stringify(a)+"</div>"},renderEmpty:function(){return"<div class='well'>Sorry! There were no results.</div>"}};return c.$el,c.page,c.offset,c.currentData,c.lastPage,c.reset=function(){c.page=1,c.currentData=null,c.lastPage=null},c.buildPage=function(){console.log("buildPage"),c.setLastPage();var a="";a+=c.buildNavigation(),a+=c.buildBody(),a+=c.buildNavigation(),c.$el.html(a),c.changeActive()},c.buildBody=function(){var a="<div class='row paginator-body-container'><div class='col-xs-12'>";if(c.currentData.rows&&0!==c.currentData.rows.length)for(var d=0;d<c.currentData.rows.length;d+=1)a+=b.render(c.currentData.rows[d]);else a+=b.renderEmpty();return a+="</div></div>"},c.buildNavigation=function(){var a="",b=c.page,d=c.lastPage;if(a+="<div class='row paginator-pagination-container'><div class='col-xs-12'>",a+="<div class='btn-group pull-right'>",a+="<a href='' class='btn btn-default' id='paginator-prev-page'>&#60;</a>",d>=1)if(d<6){for(var e=1,f=[];e<=d;e+=1)f.push(e);a+=c.buildButtons(f)}else a+=b+1>=d?c.buildButtons([1,"...",d-2,d-1,d]):b<=2?c.buildButtons([1,2,3,"...",d]):c.buildButtons([1,"...",b-1,b,b+1,"...",d]);else a+="<a href='' class='btn btn-default paginator-set-page' page='0'>0</a>";return a+="<a href=''class='btn btn-default' id='paginator-next-page'>&#62;</a>",a+="</div>",a+="</div></div>"},c.buildButtons=function(a){for(var c="",d=0;d<a.length;d+=1)"..."!==a[d]?c+="<a href='' class='btn "+b.btnDefault+" paginator-set-page' page='"+a[d]+"'>"+a[d]+"</a>":c+="<div class='btn "+b.btnDefault+"'>...</div>";return c},c.changeActive=function(){a(".paginator-pagination-container ."+b.btnDefault+"[page='"+c.page+"']").removeClass(b.btnDefault).addClass(b.btnActive)},c.run=function(){c.fetch(function(){c.buildPage()})},c.fetch=function(d){if(c.setOffset(),b.data)return c.parseClient(),d();a.get(b.url,c.parseFetchParams()).done(function(a){var e=b.parse(a);return"client"===b.pagination?(b.data=e,c.parseClient()):c.currentData=e,d()}).fail(function(c,d,e){console.log(e),a.error("fetch : failed to get data from "+b.url)})},c.parseClient=function(){var a=c.offset+b.pageSize,a=b.data.length<a?b.data.length:a;c.currentData={total:b.data.length,rows:b.data.slice(c.offset-1,a-1)}},c.parseFetchParams=function(){return"client"===b.pagination?b.params:a.extend({},b.params,{limit:b.pageSize,offset:c.offset})},c.setLastPage=function(){c.lastPage=Math.ceil(c.currentData.total/b.pageSize)},c.setOffset=function(){c.offset=(c.page-1)*b.pageSize+1},a("body").on("click","#paginator-next-page",function(a){a.preventDefault(),c.$el.paginator("nextPage")}),a("body").on("click","#paginator-prev-page",function(a){a.preventDefault(),c.$el.paginator("prevPage")}),a("body").on("click",".paginator-set-page",function(b){b.preventDefault(),c.$el.paginator("setPage",a(b.currentTarget).attr("page"))}),{init:function(e){if(console.log("init"),c.reset(),c.$el=a(this),b={},a.extend(b,d,e),!b.data&&!b.url)return a.error("init : data/url : [data] or [url] is required");b.pagination="server"!==b.pagination?"client":b.pagination,c.run()},setPage:function(b){if(console.log("setPage"),(b=parseInt(b))<1||b>c.lastPage)return a.error("setPage : invalid page number");c.page=b,c.run()},nextPage:function(){if(console.log("nextPage"),c.page>=c.lastPage)return a.error("nextPage : there is no next page");c.page+=1,c.run()},prevPage:function(){if(console.log("prevPage"),c.page<=1)return a.error("prevPage : there is no previous page");c.page-=1,c.run()}}}();a.fn.paginator=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.paginator"):b.init.apply(this,arguments)}}(jQuery);
